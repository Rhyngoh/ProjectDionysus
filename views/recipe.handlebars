<div class="row">
    <div class="col s12">
      <h2 id="recipename"></h2>
    </div>
</div>
<div class="row">
  <div class="col s6">
    <div id="imgbox">
    </div>
  </div>
  <div class="col s6">
    <ul id="recipeingredients">
    </ul>
    <form action="" method="POST" id="recForm">
    <span class="buttonWrapper"><a class="waves-effect waves-light btn additembtn" id="{{this.id}}" data-recipe_name="{{this.recipe_name}}" data-id="{{this.id}}" data-ingredients="{{this.raw_ingredients}}">Add to List</a></span>
    <button type="submit" class="waves-effect waves-light btn recommend"><i class="material-icons left">thumb_up</i>Recommend</button>
    </form>
    
  </div> 
</div>
<div class="row">
  <div class="col s12">
    <div id="instructions">
    </div>
  </div>
</div>
<script type="text/javascript">
  window.onload = function(){
    $.get("/recipe/id/{{idnumber}}", function(response){
    console.log(response);
    $("#recipename").html(response.recipe_name);
    var ingArray = [];
    var ingArray = response.ingredients.split(/,(?=\S)/);
    for(var i = 0; i < ingArray.length; i++){
      $("#recipeingredients").append("<li>"+ingArray[i]+"</li>");
    }
    $("#imgbox").append("<img src='" + response.recipe_image + "' alt='" + response.recipe_name + "'>");
    $("#instructions").append(response.instructions);
    $(document).on("click", ".additembtn", function(e){
      var oldstore = localStorage.getItem("ingredients");
      if(oldstore === null) oldstore = "";
      console.log(response.raw_ingredients);
      localStorage.setItem("ingredients", oldstore + "," + response.raw_ingredients);
    })
    $(".recommend").attr("id", response.id);
    //$("form").attr("action","/recipe/update/recommend/"+response.id+"_method=PUT");
    $(".recommend").on("click", function(e){
      e.preventDefault();
      $.ajax({
        method: "PUT",
        url: "/recipe/update/recommend/"+response.id,
        data: {recommendations:response.recommendations+1, id:response.id}
      }).done(function(){
        console.log("updated recommendations")
      });
    })
  });
  }
   
</script>