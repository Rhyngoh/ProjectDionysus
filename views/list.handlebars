<div class="row">
  <div class="col s12 m12">
    <h2>Shopping List</h2>
    <div class="input-field col s6">
      <input id="addItem" type="text" class="validate">
      <label for="addItem">Add an Item</label>
      <button class="btn waves-effect waves-light" type="submit" id="additembutton" name="action">Add
        <i class="material-icons right">send</i>
      </button>
    </div>
    <div class = "col s6">
    <p>Already have something? Click an item to remove it from the list.</p>
    <ul id="shoppingListItems">
    </ul>
    </div>
    
    <button id="clearbtn" type="button">Clear List</button>
  </div>
</div>
<script type="text/javascript">
  window.onload = function(){
    var storagevariable = window.localStorage.getItem("ingredients");
    console.log(storagevariable);
    var uniqueIng = [];
    var storagearray = storagevariable.split(",");
    $.each(storagearray, function(i, el){
      if($.inArray(el, uniqueIng) === -1){
        uniqueIng.push(el);
      }
    });
    for(var i = 0; i < uniqueIng.length; i++){
      $("#shoppingListItems").append("<li class='item'>"+uniqueIng[i]+"</li>");
    }
    $(document).on("click",".item", function(){
      console.log($(this).text());
      for (var i =0; i < uniqueIng.length; i++){
        if (uniqueIng[i] === $(this).text()){
          uniqueIng.splice(i,1);
        }
      }
      //localStorage.removeItem(this);
      this.remove();
      window.localStorage.setItem("ingredients", uniqueIng.join(","));
    })
    $("#clearbtn").on("click", function(){
      localStorage.clear();
      window.location.reload();
    });
    $("#additembutton").on("click", function(){
      var newItem = $("#addItem").val().trim();
      uniqueIng.push(newItem);
      window.localStorage.setItem("ingredients", uniqueIng.join(","));
      $("#shoppingListItems").append("<li class='item'>"+newItem+"</li>");
      $("#addItem").val("");
    });
    $(document).keypress(function (e){
      if(e.which == 13 || e.keyCode == 13){
        if($("#addItem").val().trim() !== ""){
          var newItem = $("#addItem").val().trim();
          uniqueIng.push(newItem);
          window.localStorage.setItem("ingredients", uniqueIng.join(","));
          $("#shoppingListItems").append("<li class='item'>"+newItem+"</li>");
          $("#addItem").val("");
        }
      }
    });
  }
  

</script>